<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lecture de Notes</title>
  <link rel="stylesheet" href="unified.css">
</head>
<body>
  <h1>Lecture de Notes Express</h1>

  <div class="section">
    <!-- MODE DE JEU -->
    <div class="mode-buttons">
      <p>Choisissez un mode de jeu pour travailler la lecture de notes :</p>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;max-width:680px;margin:0 auto;">
        <button id="btn-cle" style="width:100%" onclick="choisirMode(this, 'cle')">Cl√©</button>
        <button id="btn-instrument" style="width:100%" onclick="choisirMode(this, 'instrument')">Instruments</button>
        <button id="btn-defi" style="width:100%" onclick="choisirMode(this, 'defi')">D√©fi</button>
      </div>
    </div>

    <!-- SECTION CL√âS -->
    <div id="etape-cle" class="step-container fade hidden">
      <h3>Choisissez une cl√©</h3>
      <div id="cle-buttons"
           style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;max-width:520px;margin:0 auto;">
        <button style="width:100%;" onclick="setCle(this, 'sol')">Sol</button>
        <button style="width:100%;" onclick="setCle(this, 'fa')">Fa</button>
        <button style="width:100%;" onclick="setCle(this, 'ut3')">Ut3</button>
        <button style="width:100%;" onclick="setCle(this, 'ut4')">Ut4</button>
      </div>
    </div>

    <!-- SECTION NIVEAUX (pour le mode "Cl√©") -->
    <div id="etape-niveau" class="step-container fade hidden">
      <h3>Niveau de l'exercice</h3>
      <div id="niveaux"
           style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:14px;grid-auto-rows:1fr;align-items:stretch;">

        <div class="niveau-card" style="margin:0;line-height:1.35;will-change:transform,box-shadow;transition:transform .14s ease, box-shadow .2s ease;"
             onclick="selectNiveau(1)">
          <strong style="display:block;text-align:center;margin-bottom:6px;">Niveau 1</strong>
          <span>Les notes rep√®res</span>
        </div>

        <div class="niveau-card" style="margin:0;line-height:1.35;will-change:transform,box-shadow;transition:transform .14s ease, box-shadow .2s ease;"
             onclick="selectNiveau(2)">
          <strong style="display:block;text-align:center;margin-bottom:6px;">Niveau 2</strong>
          <span>Les notes rep√®res et leurs notes conjointes</span>
        </div>

        <div class="niveau-card" style="margin:0;line-height:1.35;will-change:transform,box-shadow;transition:transform .14s ease, box-shadow .2s ease;"
             onclick="selectNiveau(3)">
          <strong style="display:block;text-align:center;margin-bottom:6px;">Niveau 3</strong>
          <span>Les notes rep√®res et leurs tierces</span>
        </div>

        <div class="niveau-card" style="margin:0;line-height:1.35;will-change:transform,box-shadow;transition:transform .14s ease, box-shadow .2s ease;"
             onclick="selectNiveau(4)">
          <strong style="display:block;text-align:center;margin-bottom:6px;">Niveau 4</strong>
          <span>Les notes rep√®res + conjointes + tierces</span>
        </div>

        <div class="niveau-card"
             style="margin:0;line-height:1.35;grid-column:1 / -1;justify-self:center;width:min(100%,420px);
                    will-change:transform,box-shadow;transition:transform .14s ease, box-shadow .2s ease;"
             onclick="selectNiveau(5)">
          <strong style="display:block;text-align:center;margin-bottom:6px;">Niveau 5</strong>
          <span>Toutes les notes</span>
        </div>
      </div>

      <button id="go-button" class="hidden" onclick="lancerExercice('cle')">On y va üöÄ</button>
    </div>

    <!-- ===== SECTION INSTRUMENTS (progressif : famille -> instrument -> niveaux) ===== -->
    <div id="etape-instrument" class="step-container fade hidden">
      <h3>Instruments</h3>
      <p style="font-size:16px; line-height:1.6; max-width:800px;">
        Ici, tu vas am√©liorer ton accent d‚Äôinstrumentiste‚Ä¶ mais n‚Äôoublie jamais que tu es musicien :
        ta ¬´ langue ¬ª doit ma√Ætriser <strong>toutes</strong> les cl√©s üòâ
      </p>
      <p style="font-size:14px; color:#444; max-width:800px; margin-top:6px;">
        Chaque instrument a ses notes rep√®res et ses doigt√©s : entra√Æne-toi par niveaux pour d√©velopper vitesse et pr√©cision.
      </p>

      <style>
        /* Styles locaux, on ne touche pas unified.css */
        .families-row, .instruments-row, .levels-row {
          display:grid; gap:10px; max-width:900px; margin:14px auto 0;
          grid-template-columns: repeat(1, minmax(0,1fr));
        }
        @media (min-width:640px){ .families-row,.instruments-row,.levels-row{ grid-template-columns:repeat(2,1fr);} }
        @media (min-width:1024px){ .families-row,.instruments-row,.levels-row{ grid-template-columns:repeat(3,1fr);} }

        .tile {
          border:1px solid #e3e3e3; border-radius:14px; padding:14px;
          background:#fff; box-shadow:0 2px 10px rgba(0,0,0,.04);
          text-align:center; cursor:pointer; user-select:none;
          transition:transform .14s ease, box-shadow .2s ease, border-color .2s ease;
          font-weight:700;
        }
        .tile:hover { transform:translateY(-2px); box-shadow:0 8px 18px rgba(0,0,0,.12); }
        .tile.selected { border-color:#4CAF50; }
        .tile.disabled { opacity:.5; cursor:not-allowed; }
        .muted { font-size:13px; color:#666; font-weight:500; }

        .levels-row .button { padding:10px 12px; font-weight:700; }
        .hidden-soft { display:none; }
      </style>

      <!-- √âtape 1 : familles -->
      <h4 style="margin-top:18px;">1) Choisis une famille</h4>
      <div class="families-row" role="listbox" aria-label="Familles d'instruments">
        <div class="tile" role="option" tabindex="0" data-famille="cordes" onclick="selectFamille('cordes')">Cordes</div>
        <div class="tile" role="option" tabindex="0" data-famille="bois"   onclick="selectFamille('bois')">Bois</div>
        <div class="tile" role="option" tabindex="0" data-famille="vents"  onclick="selectFamille('vents')">Vents</div>
      </div>

      <!-- √âtape 2 : instruments (affich√© apr√®s choix famille) -->
      <div id="bloc-instruments" class="hidden-soft">
        <h4 style="margin-top:18px;">2) Choisis un instrument</h4>
        <div id="instruments-container" class="instruments-row" aria-label="Instruments"></div>
      </div>

      <!-- √âtape 3 : niveaux (affich√© apr√®s choix instrument) -->
      <div id="bloc-niveaux" class="hidden-soft">
        <h4 style="margin-top:18px;">3) Choisis ton niveau</h4>
        <div id="levels-container" class="levels-row" aria-label="Niveaux"></div>
      </div>
    </div>

    <!-- SECTION D√âFIS -->
    <div id="etape-defi" class="step-container fade hidden">
      <h3>Rel√®ve ton d√©fi !</h3>

      <div id="defi-cles"
           style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:14px;grid-auto-rows:1fr;align-items:stretch;">

        <div class="defi-card" style="margin:0;line-height:1.35;will-change:transform,box-shadow;transition:transform .14s ease, box-shadow .2s ease;"
             onclick="selectDefi(this, 'sol')">
          <strong style="display:block;text-align:center;margin-bottom:6px;">D√©fi Sol</strong>
          <span>Deviens le roi de la cl√© de Sol !</span>
        </div>

        <div class="defi-card" style="margin:0;line-height:1.35;will-change:transform,box-shadow;transition:transform .14s ease, box-shadow .2s ease;"
             onclick="selectDefi(this, 'fa')">
          <strong style="display:block;text-align:center;margin-bottom:6px;">D√©fi Fa</strong>
          <span>Ma√Ætrise les notes graves comme un¬∑e pro !</span>
        </div>

        <div class="defi-card" style="margin:0;line-height:1.35;will-change:transform,box-shadow;transition:transform .14s ease, box-shadow .2s ease;"
             onclick="selectDefi(this, 'ut3')">
          <strong style="display:block;text-align:center;margin-bottom:6px;">D√©fi Ut3</strong>
          <span>Prouve que tu domines l‚Äôalto !</span>
        </div>

        <div class="defi-card" style="margin:0;line-height:1.35;will-change:transform,box-shadow;transition:transform .14s ease, box-shadow .2s ease;"
             onclick="selectDefi(this, 'ut4')">
          <strong style="display:block;text-align:center;margin-bottom:6px;">D√©fi Ut4</strong>
          <span>Pour les fans de la cl√© de t√©nor !</span>
        </div>

        <div class="defi-card" style="margin:0;line-height:1.35;will-change:transform,box-shadow;transition:transform .14s ease, box-shadow .2s ease;"
             onclick="selectDefi(this, 'solfa')">
          <strong style="display:block;text-align:center;margin-bottom:6px;">D√©fi Sol + Fa</strong>
          <span>Lecture bimanuelle activ√©e !</span>
        </div>

        <!-- D√âFI ULTIME DOR√â -->
        <div id="defi-ultime" class="defi-card"
             style="margin:0;line-height:1.35;display:flex;flex-direction:column;justify-content:center;
                    background-color:gold;color:black;font-weight:bold;
                    will-change:transform,box-shadow;transition:transform .14s ease, box-shadow .2s ease;"
             onclick="selectDefi(this, 'ultime')">
          <strong style="display:block;text-align:center;margin-bottom:6px;">D√©fi Ultime</strong>
          <span>Le dieu de la lecture de notes, c‚Äôest toi ?</span>
        </div>
      </div>

      <button id="go-button-defi" class="hidden" onclick="lancerDefiChoisi()">On y va üöÄ</button>
    </div>
  </div>

  <script src="index.js"></script>
</body>
</html>
